Neural Network Tools for STM32 v1.2.0 (AI tools v5.0.0)
Created date       : 2020-05-17 11:36:12

Exec/report summary (generate dur=0.986s err=0)
------------------------------------------------------------------------------------------------------------------------
model file         : D:\ETH\Courses\ML_on_uCU\Project\MyCodeVersion\FinallWithGRU.h5
type               : keras (keras_dump)
c_name             : network
compression        : None
quantize           : None
L2r error          : NOT EVALUATED
workspace dir      : C:\Users\davam\AppData\Local\Temp\mxAI_workspace1324077632861005187852647795125379
output dir         : C:\Users\davam\.stm32cubemx\stm32ai_output

model_name         : FinallWithGRU
model_hash         : a2fd5368993dd38fd46aaf936c493ef1
input              : input_0 [12,480 items, 48.75 KiB, ai_float, FLOAT32, (96, 65, 2)]
input (total)      : 48.75 KiB
output             : activation_3 [8 items, 32 B, ai_float, FLOAT32, (8,)]
output (total)     : 32 B
params #           : 5,536 items (21.62 KiB)
macc               : 1,587,120
weights (ro)       : 21,952 (21.44 KiB) (-0.87%) 
activations (rw)   : 32,800 (32.03 KiB) 
ram (total)        : 82,752 (80.81 KiB) = 32,800 + 49,920 + 32

------------------------------------------------------------------------------------------------------------------------
id  layer (type)                      output shape      param #     connected to             macc           rom                
------------------------------------------------------------------------------------------------------------------------
0   input_0 (Input)                   (96, 65, 2)                                                                              
    conv2d (Conv2D)                   (96, 65, 8)       152         input_0                  997,640        608                
------------------------------------------------------------------------------------------------------------------------
1   batch_normalization (ScaleBias)   (96, 65, 8)       16          conv2d                                                     
------------------------------------------------------------------------------------------------------------------------
2   activation (Nonlinearity)         (96, 65, 8)                   batch_normalization                                        
------------------------------------------------------------------------------------------------------------------------
3   max_pooling2d (Pool)              (96, 8, 8)                    activation                                                 
------------------------------------------------------------------------------------------------------------------------
5   conv2d_1 (Conv2D)                 (96, 8, 8)        584         max_pooling2d            454,664        2,336              
------------------------------------------------------------------------------------------------------------------------
6   batch_normalization_1 (ScaleBias) (96, 8, 8)        16          conv2d_1                                                   
------------------------------------------------------------------------------------------------------------------------
7   activation_1 (Nonlinearity)       (96, 8, 8)                    batch_normalization_1                                      
------------------------------------------------------------------------------------------------------------------------
8   max_pooling2d_1 (Pool)            (96, 2, 8)                    activation_1                                               
------------------------------------------------------------------------------------------------------------------------
10  conv2d_2 (Conv2D)                 (96, 2, 8)        584         max_pooling2d_1          113,672        2,336              
------------------------------------------------------------------------------------------------------------------------
11  batch_normalization_2 (ScaleBias) (96, 2, 8)        16          conv2d_2                                                   
------------------------------------------------------------------------------------------------------------------------
12  activation_2 (Nonlinearity)       (96, 2, 8)                    batch_normalization_2                                      
------------------------------------------------------------------------------------------------------------------------
13  max_pooling2d_2 (Pool)            (96, 1, 8)                    activation_2                                               
------------------------------------------------------------------------------------------------------------------------
15  reshape (Reshape)                 (8, 1, 96)                    max_pooling2d_2                                            
------------------------------------------------------------------------------------------------------------------------
16  forward_gru (GRU)                 (8, 1, 4)         1,224       reshape                  9,664          4,896              
    backward_gru (GRU)                (8, 1, 4)         1,224       reshape                  9,664          4,896              
    bidirectional (Eltwise)           (8, 1, 4)                     forward_gru              32                                
                                                                    backward_gru            
------------------------------------------------------------------------------------------------------------------------
17  flatten (Reshape)                 (32,)                         bidirectional                                              
------------------------------------------------------------------------------------------------------------------------
18  dense (Dense)                     (32,)             1,056       flatten                  1,024          4,224              
------------------------------------------------------------------------------------------------------------------------
19  dense_1 (Dense)                   (16,)             528         dense                    512            2,112              
------------------------------------------------------------------------------------------------------------------------
20  dense_2 (Dense)                   (8,)              136         dense_1                  128            544                
------------------------------------------------------------------------------------------------------------------------
21  activation_3 (Nonlinearity)       (8,)                          dense_2                  120                               
------------------------------------------------------------------------------------------------------------------------
FinallWithGRU p=5536(21.62 KBytes) macc=1587120 rom=21.44 KBytes (-0.87%) ram=32.03 KiB io_ram=48.78 KiB

 
Complexity per-layer - macc=1,587,120 rom=21,952
------------------------------------------------------------------------------------------------------------------------
id      layer (type)                      macc                                    rom                                    
------------------------------------------------------------------------------------------------------------------------
0       conv2d (Conv2D)                   |||||||||||||||||||||||||||||||  62.9%  ||||                              2.8% 
5       conv2d_1 (Conv2D)                 ||||||||||||||                   28.6%  |||||||||||||||                  10.6% 
10      conv2d_2 (Conv2D)                 ||||                              7.2%  |||||||||||||||                  10.6% 
16      forward_gru (GRU)                 |                                 0.6%  |||||||||||||||||||||||||||||||  22.3% 
16      backward_gru (GRU)                |                                 0.6%  |||||||||||||||||||||||||||||||  22.3% 
16      bidirectional (Eltwise)           |                                 0.0%  |                                 0.0% 
18      dense (Dense)                     |                                 0.1%  ||||||||||||||||||||||||||       19.2% 
19      dense_1 (Dense)                   |                                 0.0%  |||||||||||||                     9.6% 
20      dense_2 (Dense)                   |                                 0.0%  ||||                              2.5% 
21      activation_3 (Nonlinearity)       |                                 0.0%  |                                 0.0% 
------------------------------------------------------------------------------------------------------------------------


Evaluation report (summary)
--------------------------------------------------
NOT EVALUATED
